<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_costing_sample">
        <t t-call="web.basic_layout">
            <div class="page">
                <t t-foreach="docs" t-as="doc">
                    <t t-set="company" t-value="res_company"/>
                    <div class="text-center">
                        <div class="row">
                            <div class="col-3 mb4">
                                <img t-if="company.logo" t-att-src="image_data_uri(company.logo)"
                                     style="max-height: 60px;" alt="Logo"/>
                            </div>
                            <div class="col-3"/>
                            <div class="col-6 text-right">
                                <span t-if="company.company_details" t-field="company.company_details"/>
                            </div>
                        </div>
                    </div>
                    <div class="container">
                        <table style="border-collapse: collapse; width: 100%; padding: 5px;" border="1">
                            <tbody>
                                <tr>
                                    <td style="width: 40%; padding: 5px;">
                                        <h2>
                                            <span style="text-decoration: underline;">COSTING SAMPLE</span>
                                        </h2>
                                    </td>
                                    <td style="width: 22%;"/>
                                    <td style="width: 38%; padding: 5px;">
                                        Print Date
                                        <t t-esc="datetime.datetime.now().strftime('%b %d, %Y %H:%M')"/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <br/>
                    <div class="container">
                        <table style="border-collapse: collapse; width: 100%; height: 72px; padding: 5px;" border="1">
                            <tbody>
                                <tr style="height: 18px; padding: 5px;">
                                    <td style="width: 15%; height: 18px; padding: 5px;">Trans No.</td>
                                    <td style="width: 2%; height: 18px; text-align: center;">:</td>
                                    <td style="width: 25%; height: 18px; padding: 5px;">
                                        <t t-esc="doc.name"/>
                                    </td>
                                    <td style="width: 6%; height: 18px;"/>
                                    <td style="width: 15%; height: 18px; padding: 5px;">Code</td>
                                    <td style="width: 2%; height: 18px; text-align: center; padding: 5px;">:</td>
                                    <td style="width: 35%; height: 18px; padding: 5px;">
                                        <t t-esc="doc.code"/>
                                    </td>
                                </tr>
                                <tr style="height: 18px; padding: 5px;">
                                    <td style="width: 15%; height: 18px; padding: 5px;">Trans Date</td>
                                    <td style="width: 2%; height: 18px; text-align: center; padding: 5px;">:</td>
                                    <td style="width: 25%; height: 18px; padding: 5px;">
                                        <t t-esc="doc.trans_date"
                                           t-options='{"widget": "date", "format": "dd-MM-yyyy"}'/>
                                    </td>
                                    <td style="width: 6%; height: 18px;"/>
                                    <td style="width: 15%; height: 18px; padding: 5px;">Stock Name</td>
                                    <td style="width: 2%; height: 18px; text-align: center; padding: 5px;">:</td>
                                    <td style="width: 35%; height: 18px; padding: 5px;">
                                        <t t-esc="doc.product_tmpl_id.name"/>
                                    </td>
                                </tr>
                                <tr style="height: 18px;">
                                    <td style="width: 15%; height: 18px; padding: 5px;">Customer</td>
                                    <td style="width: 2%; height: 18px; text-align: center; padding: 5px;">:</td>
                                    <td style="width: 25%; height: 18px; padding: 5px;">
                                        <t t-esc="doc.customer.name"/>
                                    </td>
                                    <td style="width: 6%; height: 18px;"/>
                                    <td style="width: 15%; height: 18px; padding: 5px;">Group</td>
                                    <td style="width: 2%; height: 18px; text-align: center; padding: 5px;">:</td>
                                    <td style="width: 35%; height: 18px; padding: 5px;">
                                        <t t-esc="doc.categ_id.name"/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <br/>
                        <p>
                            <strong>MATERIAL/FABRIC</strong>
                        </p>
                        <table style="border-collapse: collapse; width: 100%; padding: 5px;" border="1">
                            <thead style="font-size: 12px">
                                <tr>
                                    <td style="width: 20%; border: 1px solid black; padding: 5px;">Description</td>
                                    <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">Color</td>
                                    <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">Unit</td>
                                    <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">Sizes</td>
                                    <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">Ratio</td>
                                    <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">H.K</td>
                                    <td style="width: 15%; text-align: center; border: 1px solid black; padding: 5px;">Price</td>
                                    <td style="width: 15%; text-align: center; border: 1px solid black; padding: 5px;">Sub Total</td>
                                </tr>
                            </thead>
                            <tbody style="font-size: 12px">
                                <t t-set="total_material" t-value="0"/>
                                <t t-set="subtotal" t-value="0"/>
                                <t t-foreach="doc.bom_line_ids" t-as="bom">
                                    <tr>
                                        <td style="width: 20%; border: 1px solid black; padding: 5px;">
                                            <t t-esc="bom.product_id.name"/>
                                        </td>
                                        <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">
                                            <span t-field="bom.color.name"/>
                                        </td>
                                        <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">
                                            <t t-esc="bom.product_uom_id.name"/>
                                        </td>
                                        <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">
                                            <span t-field="bom.sizes.name"/>
                                        </td>
                                        <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">
                                            <t t-esc="bom.ratio"/>
                                        </td>
                                        <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">
                                            <t t-esc="bom.product_qty"/>
                                        </td>
                                        <td style="width: 15%; text-align: right; border: 1px solid black; padding: 5px;">
                                            <t t-esc="bom.product_id.standard_price"
                                               t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                        </td>
                                        <td style="width: 15%; text-align: right; border: 1px solid black; padding: 5px;">
                                            <t t-esc="bom.total_material"
                                               t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                            <t t-set="total_material" t-value="total_material + bom.cost_material"/>
                                            <!-- <t t-set="subtotal" t-value="bom.product_qty * bom.product_id.standard_price"/>
                                            <t t-set="total_material" t-value="total_material + subtotal"/>
                                            <t t-esc="subtotal"/> -->
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                            <tfoot>
                                <td style="width: 20%;"/>
                                <td style="width: 10%; text-align: center;"/>
                                <td style="width: 10%; text-align: center;"/>
                                <td style="width: 10%; text-align: center;"/>
                                <td style="width: 10%; text-align: center;"/>
                                <td style="width: 10%; text-align: center;"/>
                                <td style="width: 15%; text-align: center; border: 1px solid black; padding: 5px;">Total Material</td>
                                <td style="width: 15%; text-align: right; border: 1px solid black; padding: 5px;">
                                    <t t-esc="total_material"
                                       t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                </td>
                            </tfoot>
                        </table>
                        <br/>
                        <p>
                            <strong>SERVICES</strong>
                        </p>
                        <table style="border-collapse: collapse; width: 100%;" border="1">
                            <tbody style="font-size: 12px">
                                <tr>
                                    <td style="width: 10%; border: 1px solid black; padding: 5px;">Services</td>
                                    <td style="width: 18%; text-align: center; border: 1px solid black; padding: 5px;">Fabric</td>
                                    <td style="width: 18%; text-align: center; border: 1px solid black; padding: 5px;">DPT</td>
                                    <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">Qty</td>
                                    <td style="width: 12.5%; text-align: center; border: 1px solid black; padding: 5px;">Price</td>
                                    <td style="width: 6.5%; text-align: center; border: 1px solid black; padding: 5px;">Shkg.%</td>
                                    <td style="width: 10%; text-align: center; border: 1px solid black; padding: 5px;">Shkg</td>
                                    <td style="width: 15%; text-align: center; border: 1px solid black; padding: 5px;">Sub Total</td>
                                </tr>
                                <t t-set="total_services" t-value="0"/>
                                <t t-set="subtotal" t-value="0"/>
                                <t t-foreach="doc.operation_ids" t-as="op">
                                    <tr>
                                        <td style="width: 10%; border: 1px solid black; padding: 5px;">
                                            <t t-esc="op.workcenter_id.name"/>
                                        </td>
                                        <td style="width: 24%; border: 1px solid black; padding: 5px;">
                                            <t t-foreach="op.fabric_id" t-as="line">
                                                <span t-esc="line.product_id.name"/>
                                            </t>
                                        </td>
                                        <td style="width: 18%; text-align: center; border: 1px solid black; padding: 5px;">
                                            <t t-esc="op.color_id.name"/>
                                        </td>
                                        <td style="width: 7%; text-align: center; border: 1px solid black; padding: 5px;">
                                            <t t-if="op.workcenter_id.name == 'DYEING' or op.workcenter_id.name == 'PRINTING' or op.workcenter_id.name == 'WASHING'">
                                                <t t-esc="op.hk"/>
                                            </t>
                                        </td>
                                        <td style="width: 12.5%; text-align: right; border: 1px solid black; padding: 5px;">
                                            <t t-esc="op.cost_service"
                                               t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                        </td>
                                        <td style="width: 6.5%; text-align: center; border: 1px solid black; padding: 5px;">
                                            <t t-esc="op.shrinkage"/>
                                        </td>
                                        <td style="width: 7%; text-align: center; border: 1px solid black; padding: 5px;">
                                            <t t-esc="op.shkg"/>
                                        </td>
                                        <td style="width: 15%; text-align: right; border: 1px solid black; padding: 5px;">
                                            <t t-esc="op.total_services"
                                               t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                            <t t-set="total_services" t-value="total_services + op.total_services"/>
                                            <!-- <t t-set="subtotal" t-value="op.cost_service * op.shkg"/>
                                            <t t-set="total_services" t-value="total_services + subtotal"/>
                                            <t t-esc="subtotal" t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/> -->
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td style="width: 10%;"/>
                                    <td style="width: 18%; text-align: center;"/>
                                    <td style="width: 18%; text-align: center;"/>
                                    <td style="width: 10%; text-align: center;"/>
                                    <td style="width: 12.5%; text-align: center;"/>
                                    <td style="width: 16.5%; text-align: center; border: 1px solid black; padding: 5px;" colspan="2">
                                        Total Services
                                    </td>
                                    <!-- <td style="width: 10%; text-align: center;"></td> -->
                                    <td style="width: 15%; text-align: right; border: 1px solid black; padding: 5px;">
                                        <t t-esc="total_services"
                                           t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                        <br/>
                        <table style="border-collapse: collapse; width: 100%;" border="1">
                            <tbody>
                                <tr>
                                    <td style="width: 50%;">
                                        <table style="border-collapse: collapse; width: 100%; height: 36px;" border="1">
                                            <tbody>
                                                <tr>
                                                    <td style="width: 30%;"/>
                                                    <td style="width: 30%; text-align: right;"/>
                                                </tr>
                                                <tr>
                                                    <td style="width: 30%;"/>
                                                    <td style="width: 30%; text-align: right;"/>
                                                </tr>
                                                <tr>
                                                    <td style="width: 30%;"/>
                                                    <td style="width: 30%; text-align: right;"/>
                                                </tr>
                                                <tr>
                                                    <td style="width: 30%; border: 1px solid black; padding: 5px;">Margin(%)</td>
                                                    <td style="width: 30%; text-align: left; border: 1px solid black; padding: 5px;">
                                                        Suggest Price
                                                    </td>
                                                </tr>
                                                <tr style="height: 18px;">
                                                    <td style="width: 30%; height: 18px; border: 1px solid black; padding: 5px;">
                                                        <t t-esc="doc.margin * 100"/>
                                                    </td>
                                                    <td style="width: 30%; height: 18px; text-align: left; border: 1px solid black; padding: 5px;">
                                                        <t t-esc="doc.nominal_1"
                                                           t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                                    </td>
                                                </tr>
                                                <tr style="height: 18px;">
                                                    <td style="width: 30%; height: 18px; border: 1px solid black; padding: 5px;">
                                                        <t t-esc="doc.margin_2 * 100"/>
                                                    </td>
                                                    <td style="width: 30%; height: 18px; text-align: left; border: 1px solid black; padding: 5px;">
                                                        <t t-esc="doc.nominal_2"
                                                           t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                                    </td>
                                                </tr>
                                                <tr style="height: 18px;">
                                                    <td style="width: 30%; height: 18px; border: 1px solid black; padding: 5px;">
                                                        <t t-esc="doc.margin_3 * 100"/>
                                                    </td>
                                                    <td style="width: 30%; height: 18px; text-align: left; border: 1px solid black; padding: 5px;">
                                                        <t t-esc="doc.nominal_3"
                                                           t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                    <td style="width: 50%;">
                                        <table style="border-collapse: collapse; width: 100%; height: 126px;"
                                               border="1">
                                            <tbody>
                                                <tr style="height: 18px;">
                                                    <td style="width: 53.6458%; text-align: right; height: 18px; padding: 5px;">Cost
                                                        Before Over
                                                    </td>
                                                    <td style="width: 5.98955%; text-align: center; height: 18px;">:
                                                    </td>
                                                    <td style="width: 40.3645%; text-align: right; height: 18px; padding: 5px;">
                                                        <t t-set="cost_before_over"
                                                           t-value="total_services + total_material"/>
                                                        <t t-esc="cost_before_over"
                                                           t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                                    </td>
                                                </tr>
                                                <tr style="height: 18px;">
                                                    <td style="width: 53.6458%; text-align: right; height: 18px; padding: 5px;">Over
                                                        &amp; Packaging
                                                    </td>
                                                    <td style="width: 5.98955%; text-align: center; height: 18px;">:
                                                    </td>
                                                    <td style="width: 40.3645%; text-align: right; height: 18px; padding: 5px;">
                                                        <t t-esc="doc.over_packaging"
                                                           t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                                    </td>
                                                </tr>
                                                <tr style="height: 18px;">
                                                    <td style="width: 53.6458%; text-align: right; height: 18px; padding: 5px;">
                                                        Total(IDR)
                                                    </td>
                                                    <td style="width: 5.98955%; text-align: center; height: 18px;">:
                                                    </td>
                                                    <td style="width: 40.3645%; text-align: right; height: 18px; padding: 5px;">
                                                        <!-- <t t-set="total" t-value="cost_before_over + doc.over_packaging"/> -->
                                                        <t t-esc="doc.total_cost"
                                                           t-options="{'widget': 'monetary','display_currency': res_company.currency_id}"/>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <br/>
<!--                        <table style="border-collapse: collapse; width: 50%;" border="1">-->
<!--                            <tr>-->
<!--                                <td style="border: 1px solid black; font-weight:bold; padding: 5px;">Component</td>-->
<!--                                <td style="border: 1px solid black; font-weight:bold; padding: 5px;">Sizes</td>-->
<!--                                <td style="text-align: right; border: 1px solid black;font-weight:bold; padding: 5px;">-->
<!--                                    Quantity-->
<!--                                </td>-->
<!--                                <td style="border: 1px solid black;font-weight:bold; padding: 5px;">UoM</td>-->
<!--                            </tr>-->
<!--                            <t t-foreach="doc.bom_line_variant_ids" t-as="variant">-->
<!--                                <tr>-->
<!--                                    <td style="padding:1px;border: 1px solid black; padding: 5px;">-->
<!--                                        <t t-esc="variant.product_id.name"/>-->
<!--                                    </td>-->
<!--                                    <td style="padding:1px;border: 1px solid black; padding: 5px;">-->
<!--                                        <t t-esc="variant.sizes"/>-->
<!--                                    </td>-->
<!--                                    <td style="padding:1px;text-align: right;border: 1px solid black; padding: 5px;">-->
<!--                                        <t t-esc="variant.product_qty"/>-->
<!--                                    </td>-->
<!--                                    <td style="padding:1px;border: 1px solid black; padding: 5px;">-->
<!--                                        <t t-esc="variant.product_uom_id.name"/>-->
<!--                                    </td>-->
<!--                                </tr>-->
<!--                            </t>-->
<!--                        </table>-->
                    </div>
                </t>
            </div>
        </t>
    </template>
</odoo>
